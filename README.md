# Obsidian-Agent-Kit (OAK)

![License: MIT](https://img.shields.io/badge/License-MIT-yellow.svg)

ä¸€ä¸ªä¸º Obsidian è®¾è®¡çš„ã€æç®€è€Œå¼ºå¤§çš„ AI ä»£ç†ï¼ˆAgentï¼‰å¼€å‘å·¥å…·åŒ…ã€‚OAK æä¾›äº†ä¸€å¥—æ ¸å¿ƒæ¶æ„ï¼Œè®©ä½ èƒ½å¿«é€Ÿæ„å»ºåœ¨åå°è¿è¡Œã€å¤„ç†å¼‚æ­¥ä»»åŠ¡çš„ AI åŠŸèƒ½æ’ä»¶ã€‚

## æ ¸å¿ƒç†å¿µ

OAK çš„è®¾è®¡çµæ„Ÿæ¥æºäºâ€œä»£ç†â€æ¨¡å¼ã€‚ä½ å¯ä»¥åˆ›å»ºå¤šä¸ªç‹¬ç«‹çš„ Agentï¼Œæ¯ä¸ª Agent è´Ÿè´£ä¸€ç§ç‰¹å®šçš„ä»»åŠ¡ï¼ˆä¾‹å¦‚ï¼šå†…å®¹ç”Ÿæˆã€æ–‡ç« æ‘˜è¦ã€ä»»åŠ¡æ•´ç†ç­‰ï¼‰ã€‚è¿™äº› Agent ç”±ä¸€ä¸ªä¸­å¤®**è°ƒåº¦å™¨ï¼ˆOrchestratorï¼‰**ç®¡ç†ï¼Œé€šè¿‡ä»»åŠ¡é˜Ÿåˆ—å®ç°å¼‚æ­¥ã€éé˜»å¡çš„åå°å·¥ä½œã€‚

-   **è°ƒåº¦å™¨ (Orchestrator)**: æ’ä»¶çš„â€œå¿ƒè„â€ï¼Œåœ¨åå°å¾ªç¯è¿è¡Œï¼Œæ£€æŸ¥å„ä¸ªä»»åŠ¡é˜Ÿåˆ—å¹¶åˆ†æ´¾ä»»åŠ¡ç»™å¯¹åº”çš„ Agentã€‚
-   **ä»£ç† (Agent)**: å…·ä½“çš„â€œå·¥äººâ€ï¼Œç»§æ‰¿è‡ª `BaseAgent`ã€‚æ¯ä¸ª Agent ç›‘å¬ä¸€ä¸ªä¸“å±çš„é˜Ÿåˆ—ï¼Œå¹¶å®šä¹‰å¦‚ä½•å¤„ç†é˜Ÿåˆ—ä¸­çš„ä»»åŠ¡ã€‚
-   **é˜Ÿåˆ— (Queue)**: ä»»åŠ¡çš„â€œä¼ é€å¸¦â€ã€‚ä»»ä½•åœ°æ–¹éƒ½å¯ä»¥å‘æŒ‡å®šé˜Ÿåˆ—æ·»åŠ ä»»åŠ¡ï¼Œè°ƒåº¦å™¨ä¼šè‡ªåŠ¨æ‹¾å–ã€‚
-   **LLMProvider**: ç»Ÿä¸€çš„è¯­è¨€æ¨¡å‹æ¥å£ï¼Œè½»æ¾åˆ‡æ¢å’Œä½¿ç”¨ä¸åŒçš„ AI æœåŠ¡ï¼ˆå½“å‰å·²æ”¯æŒ OpenAI å…¼å®¹æ¥å£å’Œ Google Geminiï¼‰ã€‚

## âœ¨ åŠŸèƒ½ç‰¹æ€§

-   **åå°ä»»åŠ¡å¤„ç†**: æ‰€æœ‰ AI ä»»åŠ¡éƒ½åœ¨åå°å¼‚æ­¥æ‰§è¡Œï¼Œä¸é˜»å¡ä½ çš„å†™ä½œæµç¨‹ã€‚
-   **æ¨¡å—åŒ– Agent è®¾è®¡**: æ–¹ä¾¿æ‰©å±•ï¼Œæ¯ä¸ªåŠŸèƒ½éƒ½æ˜¯ä¸€ä¸ªç‹¬ç«‹çš„ Agentï¼Œé€»è¾‘æ¸…æ™°ã€‚
-   **ä»»åŠ¡é˜Ÿåˆ—ç³»ç»Ÿ**: å¯é åœ°å¤„ç†ä»»åŠ¡ï¼Œå³ä½¿ä¸€æ¬¡æ€§æ·»åŠ å¤§é‡ä»»åŠ¡ä¹Ÿä¸ä¼šå¡é¡¿ã€‚
-   **å¤š LLM æ”¯æŒ**: å·²å†…ç½® OpenAI (åŠå…¼å®¹ API, å¦‚ DeepSeek, Moonshot) å’Œ Google Gemini çš„æ”¯æŒã€‚
-   **çµæ´»çš„ UI äº¤äº’**: æä¾›äº†å‘½ä»¤é¢æ¿ã€çŠ¶æ€æ å›¾æ ‡å’Œè‡ªå®šä¹‰å¼¹çª—ç­‰å¤šç§æ–¹å¼ä¸ç”¨æˆ·äº¤äº’ã€‚
-   **æ¸…æ™°çš„é…ç½®ç®¡ç†**: æ‰€æœ‰è®¾ç½®é¡¹éƒ½åœ¨ä¸€ä¸ªç‹¬ç«‹çš„è®¾ç½®é¢æ¿ä¸­ï¼Œæ–¹ä¾¿ç”¨æˆ·é…ç½®ã€‚

## ğŸš€ å¿«é€Ÿå¼€å§‹

1.  **å®‰è£…**:
    *   å°†é¡¹ç›®å…‹éš†æˆ–ä¸‹è½½åˆ°ä½ çš„ Obsidian æ’ä»¶ç›®å½• (`.obsidian/plugins/`)ã€‚
    *   åœ¨æ’ä»¶ç›®å½•ä¸­è¿è¡Œ `npm install` å®‰è£…ä¾èµ–ã€‚
    *   è¿è¡Œ `npm run build` æ¥ç¼–è¯‘ TypeScript ä»£ç ã€‚
    *   åœ¨ Obsidian ä¸­å¯ç”¨ "OAK Agent Kit" æ’ä»¶ã€‚

2.  **é…ç½®**:
    *   è¿›å…¥ Obsidian çš„è®¾ç½® -> "OAK Agent Kit"ã€‚
    *   é€‰æ‹©ä½ æƒ³è¦ä½¿ç”¨çš„ AI æä¾›å•†ï¼ˆOpenAI æˆ– Googleï¼‰ã€‚
    *   å¡«å…¥ä½ çš„ API Key å’Œå…¶ä»–ç›¸å…³ä¿¡æ¯ï¼ˆå¦‚ Base URLã€æ¨¡å‹åç§°ï¼‰ã€‚
    *   ä½ å¯ä»¥è‡ªå®šä¹‰è¾“å‡ºç›®å½•å’Œ Prompt æ¨¡æ¿ã€‚

3.  **ä½¿ç”¨ (ç¤ºä¾‹ï¼šæ¦‚å¿µç”Ÿæˆå™¨)**:
    *   ç‚¹å‡» Obsidian å·¦ä¾§è¾¹æ çš„æœºå™¨äºº (`bot`) å›¾æ ‡ã€‚
    *   åœ¨å¼¹å‡ºçš„çª—å£ä¸­è¾“å…¥ä¸€ä¸ªæ¦‚å¿µï¼Œä¾‹å¦‚â€œç¬¬ä¸€æ€§åŸç†â€ã€‚
    *   ç‚¹å‡»â€œæ·»åŠ åˆ°é˜Ÿåˆ—â€ã€‚
    *   OAK å¼•æ“ä¼šè‡ªåŠ¨å¯åŠ¨ï¼Œåœ¨åå°è°ƒç”¨ AI ç”Ÿæˆå…³äºè¯¥æ¦‚å¿µçš„ç¬”è®°ï¼Œå¹¶ä¿å­˜åˆ°ä½ è®¾ç½®çš„è¾“å‡ºæ–‡ä»¶å¤¹ä¸­ã€‚
    *   ä½ ä¹Ÿå¯ä»¥é€šè¿‡å‘½ä»¤é¢æ¿ (`Ctrl/Cmd + P`) è¿è¡Œ "æ·»åŠ æ–°æ¦‚å¿µåˆ°ç”Ÿæˆé˜Ÿåˆ—" æ¥è§¦å‘æ­¤åŠŸèƒ½ã€‚

## ğŸ§‘â€ğŸ’» å¯¹äºå¼€å‘è€…ï¼šå¦‚ä½•åˆ›å»ºæ–°çš„ Agent

OAK çš„é­…åŠ›åœ¨äºå®ƒçš„å¯æ‰©å±•æ€§ã€‚åˆ›å»ºä¸€ä¸ªæ–°çš„ Agent éå¸¸ç®€å•ï¼š

1.  **åˆ›å»º Agent æ–‡ä»¶**:
    åœ¨ `src/agents/` ç›®å½•ä¸‹åˆ›å»ºä¸€ä¸ªæ–°æ–‡ä»¶ï¼Œä¾‹å¦‚ `SummarizerAgent.ts`ã€‚

2.  **ç¼–å†™ Agent ä»£ç **:
    ç»§æ‰¿ `BaseAgent` å¹¶å®ç° `queueName` å’Œ `process` æ–¹æ³•ã€‚

    ```typescript
    // src/agents/SummarizerAgent.ts
    import { BaseAgent } from "../core/BaseAgent";
    import { App, Notice } } from "obsidian";

    // å®šä¹‰ä»»åŠ¡é¡¹çš„ç±»å‹
    interface SummarizeTask {
        filePath: string;
        content: string;
    }

    export class SummarizerAgent extends BaseAgent<SummarizeTask> {
        // 1. å®šä¹‰æ­¤ Agent ç›‘å¬çš„é˜Ÿåˆ—åç§°
        get queueName(): string {
            return "summarize_queue";
        }

        // 2. å®ç°å¤„ç†é€»è¾‘
        async process(task: SummarizeTask): Promise<boolean> {
            new Notice(`æ­£åœ¨ä¸º ${task.filePath} ç”Ÿæˆæ‘˜è¦...`);

            const prompt = `è¯·ä¸ºä»¥ä¸‹å†…å®¹ç”Ÿæˆä¸€æ®µç®€æ´çš„æ‘˜è¦ï¼š\n\n${task.content}`;
            const summary = await this.llm.chat(prompt);

            if (!summary) {
                new Notice("æ‘˜è¦ç”Ÿæˆå¤±è´¥ï¼");
                return false; // è¿”å› false è¡¨ç¤ºä»»åŠ¡å¤±è´¥ï¼Œä¸ä¼šä»é˜Ÿåˆ—ä¸­ç§»é™¤
            }
            
            // å°†æ‘˜è¦è¿½åŠ åˆ°åŸæ–‡ä»¶æœ«å°¾
            await this.app.vault.append(
                this.app.vault.getAbstractFileByPath(task.filePath),
                `\n\n---\n**AI æ‘˜è¦:**\n${summary}`
            );
            
            new Notice(`æ–‡ä»¶ ${task.filePath} çš„æ‘˜è¦å·²ç”Ÿæˆï¼`);
            return true; // è¿”å› true è¡¨ç¤ºä»»åŠ¡æˆåŠŸ
        }
    }
    ```

3.  **æ³¨å†Œ Agent**:
    åœ¨ `main.ts` çš„ `onload` æ–¹æ³•ä¸­ï¼Œå®ä¾‹åŒ–å¹¶æ³¨å†Œä½ çš„æ–° Agentã€‚

    ```typescript
    // main.ts
    import { SummarizerAgent } from "./agents/SummarizerAgent"; // å¯¼å…¥æ–° Agent

    // ... in onload() method
    this.orchestrator.registerAgent(new GeneratorAgent(this as any, this.llm));
    this.orchestrator.registerAgent(new SummarizerAgent(this as any, this.llm)); // æ³¨å†Œä½ çš„æ–° Agent
    ```

ç°åœ¨ï¼Œä½ å°±å¯ä»¥åœ¨æ’ä»¶çš„ä»»ä½•åœ°æ–¹è°ƒç”¨ `this.orchestrator.addToQueue("summarize_queue", { filePath: '...', content: '...' })` æ¥ä½¿ç”¨ä½ çš„æ–°åŠŸèƒ½äº†ï¼

## ğŸ“„ è®¸å¯è¯

æœ¬é¡¹ç›®é‡‡ç”¨ [MIT](LICENSE) è®¸å¯è¯ã€‚
